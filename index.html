<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WordSearch 1v1</title>
    
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
    
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="game.css">
    <link rel="stylesheet" href="tuto.css">
    <link rel="stylesheet" href="winning.css">
</head>
<body>

<div id="app" v-cloak>
    
    <div v-if="screen === 'login'" class="container">
        <h1>üß© WordSearch</h1>
        <p>Masukkan nama untuk mula</p>
        <input v-model="myName" placeholder="Nama anda..." @keyup.enter="handleLogin">
        <button @click="handleLogin" class="btn-main">MASUK</button>
        <div v-if="isNameSaved" class="footer-actions">
            <button @click="deleteName" class="btn-link">Tukar Akaun</button>
        </div>
    </div>

    <div v-if="screen === 'menu'" class="container">
        <h2>Hai, {{ myName }}!</h2>
        <div class="menu-grid">
            <button @click="startSinglePlayer" class="btn-menu">üë§ Solo</button>
            <button @click="screen = 'lobby'" class="btn-menu">üë• 1v1 Lawan</button>
        </div>
        <button @click="showTutorial = true" class="btn-tutorial">‚ùì Cara Main 1v1</button>
        <button @click="exitGame" class="btn-link">Keluar</button>
    </div>

    <div v-if="screen === 'lobby'" class="container">
        <h3>Lobby 1v1</h3>
        <div class="id-box">
            <small>ID ANDA:</small>
            <div class="my-id" style="font-size: 2rem; color: #00f2ff; font-weight: bold;">{{ myId }}</div>
        </div>
        <div class="connect-box">
            <input v-model="peerIdInput" placeholder="ID Lawan" class="input-id">
            <button @click="connectToPeer" class="btn-main">SAMBUNG</button>
        </div>
        <button @click="screen = 'menu'" class="btn-link">Kembali</button>
    </div>

    <div v-if="screen === 'game'" class="game-screen">
        <div class="scoreboard">
            <div class="team">
                <div class="name">{{ myName }}</div>
                <div class="stats"><b>{{ myScore }}</b></div>
                <div v-if="mode === 'multi'" class="win-badge">{{ myWins }} Win</div>
            </div>

            <template v-if="mode === 'multi'">
                <div class="vs">VS</div>
                <div class="team">
                    <div class="name">{{ opponentName }}</div>
                    <div class="stats"><b>{{ opponentScore }}</b></div>
                    <div class="win-badge">{{ opponentWins }} Win</div>
                </div>
            </template>
        </div>

        <div class="word-list">
            <span v-for="word in words" :key="word" 
                  :class="{ 'wordFound': foundWords.includes(word) }">
                {{ word }}
            </span>
        </div>

        <div class="grid">
            <div v-for="(row, rIndex) in grid" :key="rIndex" class="grid-row">
                <div v-for="(char, cIndex) in row" :key="cIndex" 
                     class="cell" 
                     :class="{ 
                        selecting: isSelected(rIndex, cIndex), 
                        found: isFound(rIndex, cIndex)
                     }"
                     @click="handleCellClick(rIndex, cIndex, char)">
                    {{ char }}
                </div>
            </div>
        </div>

        <button @click="exitGame" class="btn-exit">Tamat</button>
    </div>

    <div v-if="showWinner" class="winner-overlay">
        <div class="winner-text">
            {{ myScore > opponentScore ? 'YOU WIN' : (myScore < opponentScore ? 'YOU LOST' : 'DRAW') }}
        </div>
        
        <div class="final-scores">
            {{ myScore }} <span style="color:#fff; font-size:1rem;">VS</span> {{ mode === 'multi' ? opponentScore : 'SCORE' }}
        </div>

        <button @click="handleNextGame" class="btn-restart">Pusingan Seterusnya</button>
        <button @click="exitGame" class="btn-link" style="color:#ff3e3e; margin-top:10px;">Tamat & Keluar</button>
    </div>

    <div v-if="showTutorial" class="modal-overlay" @click.self="showTutorial = false">
        <div class="modal-content">
            <h3>Cara Main 1v1 üß©</h3>
            <p>1. Pilih 1v1. 2. Bagi ID kat kawan. 3. Kawan masukkan ID & Sambung.</p>
            <button @click="showTutorial = false" class="btn-close-tuto">Faham!</button>
        </div>
    </div>

</div>

<script type="module" src="script.js"></script>
<script type="module" src="tuto.js"></script>

</body>
</html>
