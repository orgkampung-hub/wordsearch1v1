<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Search Neon</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="game.css">
    <link rel="stylesheet" href="winning.css">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <script src="https://unpkg.com/peerjs@1.5.2/dist/peerjs.min.js"></script>
</head>
<body>

    <div id="app">
        <div v-if="foundWords.length === words.length && words.length > 0" class="winner-overlay">
            <div class="winner-text">
                {{ myScore > opponentScore ? 'YOU WIN!' : (myScore < opponentScore ? 'GAME OVER' : 'DRAW!') }}
            </div>
            <div class="final-scores">
                SCORE: {{ myScore }} - {{ opponentScore }}
            </div>
            <button @click="nextGame" class="btn-restart">PUSINGAN SETERUSNYA</button>
            <button @click="window.location.reload()" class="btn-exit" style="margin-top:10px; border:none">TAMAT</button>
        </div>

        <div v-if="screen === 'login'" class="screen">
            <h1>WORD SEARCH</h1>
            <div class="p2p-box">
                <div v-if="!isNameSaved">
                    <input v-model="myName" type="text" placeholder="Nama Anda">
                    <button @click="handleLogin" class="btn-main" :disabled="!myName">MASUK</button>
                </div>
                <div v-else>
                    <p>Selamat Datang,</p>
                    <h2 style="color:#ff00ff; margin: 10px 0;">{{ myName }}</h2>
                    <button @click="handleLogin" class="btn-main">MAIN SEKARANG</button>
                    <button @click="deleteName" class="btn-exit" style="border:none; text-decoration:underline; font-size:0.8rem">Tukar Nama / Reset</button>
                </div>
            </div>
        </div>

        <div v-if="screen === 'menu'" class="screen">
            <h1>WORD SEARCH</h1>
            <p>ID ANDA: <b style="color:#00f2ff">{{ myId }}</b></p>
            
            <div class="mode-selector">
                <button @click="startSinglePlayer" class="btn-main">Single Player</button>
                <button @click="mode = 'multi'" class="btn-main">Multiplayer (1v1)</button>
            </div>

            <div v-if="mode === 'multi'" class="p2p-box">
                <input v-model="peerIdInput" type="text" placeholder="ID Lawan">
                <button @click="connectToPeer" class="btn-sub">Connect & Play</button>
            </div>
        </div>

        <div v-if="screen === 'game'" class="screen game-screen">
            <div class="scoreboard">
                <div class="team">
                    <span class="name">{{ myName }}</span>
                    <div class="stats"><b>{{ myScore }}</b> <small>(WINS: {{ myWins }})</small></div>
                </div>
                <div v-if="mode === 'multi'" class="vs">VS</div>
                <div v-if="mode === 'multi'" class="team">
                    <span class="name">{{ opponentName }}</span>
                    <div class="stats"><b>{{ opponentScore }}</b> <small>(WINS: {{ opponentWins }})</small></div>
                </div>
            </div>

            <div class="word-list">
                <span v-for="word in words" :key="word" :class="{ wordFound: foundWords.includes(word) }">
                    {{ word }}
                </span>
            </div>

            <div class="grid">
                <div v-for="(row, r) in grid" :key="r" class="grid-row">
                    <div v-for="(char, c) in row" :key="c" 
                         class="cell" 
                         :class="{ 
                            selecting: isSelected(r, c), 
                            found: isFound(r, c),
                            'animate-found': shouldAnimate(r, c) 
                         }"
                         @click="handleCellClick(r, c, char)">
                        {{ char }}
                    </div>
                </div>
            </div>
            
            <button v-if="foundWords.length === words.length && words.length > 0" 
                    @click="nextGame" class="btn-main" style="margin: 10px 0;">NEXT GAME</button>
            <button @click="screen = 'menu'" class="btn-exit">Keluar</button>
        </div>
    </div>

    <script type="module" src="script.js"></script>
</body>
</html>
